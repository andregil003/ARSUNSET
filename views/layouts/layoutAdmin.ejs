<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | Artesanías Sunset</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/colors.css">
    <link rel="stylesheet" href="/css/icons.css">
    <link rel="stylesheet" href="/css/main.css"> <!-- Base styles -->
    <link rel="stylesheet" href="/css/admin.css"> <!-- Admin overrides -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <% if (locals.csrfToken) { %>
        <meta name="csrf-token" content="<%= csrfToken %>">
        <% } %>
</head>

<body class="admin-wrapper">

    <!-- Header -->
    <header class="admin-header">
        <div class="flex items-center">
            <button class="sidebar-toggler mr-4 lg:hidden">
                <i class="icon-menu"></i>
            </button>
            <a href="/admin" class="admin-brand">Sunset Admin</a>
        </div>

        <div class="flex items-center gap-4">
            <div class="text-sm text-gray-600 hidden md:block">
                Hola, <strong>
                    <%= locals.user ? user.full_name : 'Admin' %>
                </strong>
            </div>
            <a href="/" class="text-gray-600 hover:text-primary" title="Ver Sitio">
                <i class="icon-eye"></i>
            </a>
            <a href="/auth/logout" class="text-error hover:text-red-700" title="Salir">
                <i class="icon-logout"></i>
            </a>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <nav class="sidebar-nav">
            <a href="/admin" class="sidebar-link <%= locals.path === '/admin' ? 'active' : '' %>">
                <i class="icon-grid"></i> Dashboard
            </a>
            <a href="/admin/productos"
                class="sidebar-link <%= locals.path && path.includes('/productos') ? 'active' : '' %>">
                <i class="icon-box"></i> Productos
            </a>
            <a href="/admin/categorias"
                class="sidebar-link <%= locals.path && path.includes('/categorias') ? 'active' : '' %>">
                <i class="icon-tag"></i> Categorías
            </a>
            <a href="/admin/ordenes"
                class="sidebar-link <%= locals.path && path.includes('/ordenes') ? 'active' : '' %>">
                <i class="icon-bag"></i> Órdenes
            </a>
            <a href="/admin/usuarios"
                class="sidebar-link <%= locals.path && path.includes('/usuarios') ? 'active' : '' %>">
                <i class="icon-user"></i> Usuarios
            </a>
            <a href="/admin/blog" class="sidebar-link <%= locals.path && path.includes('/blog') ? 'active' : '' %>">
                <i class="icon-edit"></i> Blog
            </a>
            <a href="/admin/configuracion"
                class="sidebar-link <%= locals.path && path.includes('/configuracion') ? 'active' : '' %>">
                <i class="icon-filter"></i> Configuración
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
        <% if (locals.messages) { %>
            <% if (messages.error) { %>
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                    <%= messages.error %>
                </div>
                <% } %>
                    <% if (messages.success) { %>
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
                            <%= messages.success %>
                        </div>
                        <% } %>
                            <% } %>

                                <% if (locals.view) { %>
                                    <%- include('../' + view) %>
                                        <% } else { %>
                                            <%- locals.body || '' %>
                                                <% } %>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" defer></script>
    <script src="/js/main.js" defer></script>
    <!-- Admin specific scripts could go here -->
    <script>
        // Simple sidebar toggle logic for admin
        document.addEventListener('DOMContentLoaded', () => {
            const toggler = document.querySelector('.sidebar-toggler');
            const sidebar = document.querySelector('.admin-sidebar');
            if (toggler && sidebar) {
                toggler.addEventListener('click', () => {
                    sidebar.classList.toggle('show');
                });
            }
        });
    </script>
</body>

</html>